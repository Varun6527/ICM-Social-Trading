import{a as ce}from"./chunk-E7P3D5E6.js";import{a as se}from"./chunk-KKBRAPKR.js";import"./chunk-DRFXQGFU.js";import"./chunk-ELFW3MCS.js";import{a as le}from"./chunk-ZMEXDH5L.js";import{b as ne,c as oe}from"./chunk-BUFGAGPR.js";import{c as ee,i as te,o as ie,q as re,r as ae,u as S,v as de}from"./chunk-BBDCSVIU.js";import{a as G}from"./chunk-D2HZNMZZ.js";import{Aa as X,Ea as Y,Ga as Z,Ma as $,O as z,Oa as y,T as Q,U,V as q,va as K}from"./chunk-GPXXUB3O.js";import{$b as k,Bb as b,Bc as j,Da as x,Ha as _,Kc as H,Lc as J,Ma as M,O as E,Qa as n,R as O,Ra as i,Rb as L,Sa as h,Sb as N,Va as v,W as f,X as u,Ya as w,_a as m,_b as W,eb as A,fb as B,gb as R,lb as o,mb as s,nb as C,oa as t,ob as T,pa as P,qb as D,rb as F,sb as I,ub as V,yb as r,zb as c}from"./chunk-VFCAWHKN.js";import"./chunk-XTLRYQGA.js";function pe(d,g){if(d&1&&(n(0,"div",22)(1,"p"),o(2),r(3,"translate"),i(),n(4,"h3"),o(5),r(6,"currency"),i()()),d&2){let e=g.$implicit;t(2),T("",c(3,3,"TRANSACTIONS.Subscription")," #",e.id,""),t(3),s(b(6,5,e.value,"USD","symbol"))}}function me(d,g){if(d&1){let e=v();n(0,"button",14),w("click",function(){f(e);let l=m(2);return u(l.clearFilters())}),h(1,"img",23),o(2),r(3,"translate"),i()}d&2&&(t(2),C(" ",c(3,1,"COMMON.Clear")," "))}function fe(d,g){if(d&1){let e=v();n(0,"mat-form-field")(1,"mat-label"),o(2),r(3,"translate"),i(),n(4,"input",24),I("ngModelChange",function(l){f(e);let p=m(2);return F(p.selectedFilters.id,l)||(p.selectedFilters.id=l),u(l)}),i()(),n(5,"mat-form-field")(6,"mat-label"),o(7),r(8,"translate"),i(),n(9,"input",24),I("ngModelChange",function(l){f(e);let p=m(2);return F(p.selectedFilters.externalAccount,l)||(p.selectedFilters.externalAccount=l),u(l)}),i()(),n(10,"mat-form-field")(11,"mat-label"),o(12),r(13,"translate"),i(),n(14,"mat-select",25),I("ngModelChange",function(l){f(e);let p=m(2);return F(p.selectedFilters.status,l)||(p.selectedFilters.status=l),u(l)}),w("selectionChange",function(){f(e);let l=m(2);return u(l.refreshFollowerDataList())}),n(15,"mat-option",26),o(16),r(17,"translate"),i(),n(18,"mat-option",26),o(19),r(20,"translate"),i()()()}if(d&2){let e=m(2);t(2),s(c(3,10,"COMMON.Id")),t(2),D("ngModel",e.selectedFilters.id),t(3),s(c(8,12,"TRANSACTIONS.Account")),t(2),D("ngModel",e.selectedFilters.externalAccount),t(3),s(c(13,14,"PROVIDERS_PROFILE.Scope")),t(2),D("ngModel",e.selectedFilters.status),t(),_("value","Active"),t(),s(c(17,16,"COMMON.Active")),t(2),_("value","All"),t(),s(c(20,18,"COMMON.All"))}}function ue(d,g){d&1&&(h(0,"img",27),o(1),r(2,"translate")),d&2&&(t(),C(" ",c(2,1,"PROVIDERS_LIST.Search")," "))}function he(d,g){d&1&&(h(0,"img",28),o(1),r(2,"translate")),d&2&&(t(),C(" ",c(2,1,"COMMON.Refresh")," "))}function _e(d,g){if(d&1){let e=v();n(0,"mat-card-content",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"h5"),o(5),r(6,"translate"),i(),n(7,"p"),o(8),r(9,"translate"),i()()(),n(10,"div",7)(11,"div",8)(12,"h6"),o(13),r(14,"translate"),i(),n(15,"div",9)(16,"h5"),o(17),r(18,"translate"),i(),n(19,"h5"),o(20),i()(),n(21,"div",9)(22,"h5"),o(23),r(24,"translate"),i(),n(25,"h5"),o(26),i()()(),n(27,"div",8)(28,"h6"),o(29),r(30,"translate"),i(),n(31,"div",9)(32,"h5"),o(33),r(34,"translate"),i(),n(35,"h5"),o(36),r(37,"currency"),i()(),n(38,"div",9)(39,"h5"),o(40),r(41,"translate"),i(),n(42,"h5"),o(43),r(44,"currency"),i()()(),n(45,"div",8)(46,"h6"),o(47),r(48,"translate"),i(),n(49,"div",9)(50,"h5"),o(51),r(52,"translate"),i(),n(53,"h5"),o(54),r(55,"currency"),i()(),n(56,"div",9)(57,"h5"),o(58),r(59,"translate"),i(),n(60,"h5"),o(61),r(62,"currency"),i()()(),n(63,"div",8)(64,"h6"),o(65),r(66,"translate"),i(),x(67,pe,7,9,"div",10),i()(),n(68,"div",11)(69,"div",12)(70,"div",13)(71,"button",14),w("click",function(){f(e);let l=m();return u(l.applyFollowerFilter())}),h(72,"img",15),o(73),r(74,"translate"),i(),x(75,me,4,3,"button",16),i(),n(76,"div",17),x(77,fe,21,20),n(78,"button",18),w("click",function(){f(e);let l=m();return u(l.refreshFollowerDataList())}),x(79,ue,3,3)(80,he,3,3),i(),n(81,"button",19),w("click",function(){f(e);let l=m();return u(l.openNewFollowerDialog())}),h(82,"img",20),o(83),r(84,"translate"),i()()(),h(85,"common-ag-grid",21),i()()()}if(d&2){let e=m();t(5),s(c(6,27,"SIDEBAR.My Portfolio")),t(3),s(c(9,29,"PROVIDERS_PROFILE.List of subscriptions")),t(5),s(c(14,31,"PROVIDERS_PROFILE.Subscriptions' Activity")),t(4),s(c(18,33,"COMMON.Active")),t(3),s(e.followerDashBoardData==null?null:e.followerDashBoardData.activeCount),t(3),s(c(24,35,"COMMON.Inactive")),t(3),s(e.followerDashBoardData==null?null:e.followerDashBoardData.inActiveCount),t(3),s(c(30,37,"PROVIDERS_PROFILE.Profit")),t(4),s(c(34,39,"PROVIDERS.This month")),t(3),s(b(37,41,e.followerDashBoardData==null?null:e.followerDashBoardData.thisMonthProfit,"USD","symbol")),t(4),s(c(41,45,"PROVIDERS.Previous month")),t(3),s(b(44,47,e.followerDashBoardData==null?null:e.followerDashBoardData.previousMonthProfit,"USD","symbol")),t(4),s(c(48,51,"PROVIDERS.Performance Fee")),t(4),s(c(52,53,"PROVIDERS.This month")),t(3),s(b(55,55,e.followerDashBoardData==null?null:e.followerDashBoardData.thisMonthPaidFees,"USD","symbol")),t(4),s(c(59,59,"PROVIDERS.Previous month")),t(3),s(b(62,61,e.followerDashBoardData==null?null:e.followerDashBoardData.previousMonthPaidFees,"USD","symbol")),t(4),s(c(66,65,"PROVIDERS_PROFILE.Profitable Subscriptions")),t(2),_("ngForOf",e.followerDashBoardData.subscriptionsRating),t(6),C(" ",c(74,67,"COMMON.Filters")," "),t(2),_("ngIf",e.showFilters),t(2),M(e.showFilters?77:-1),t(2),M(e.selectedFilters.externalAccount||e.selectedFilters.id?79:80),t(4),C(" ",c(84,69,"COMMON.Create")," "),t(2),_("gridConfig",e.gridConfig)("gridData",e.followerTableData)("showGridLoader",e.showGridLoader)}}function ge(d,g){d&1&&(n(0,"div",29),h(1,"img",30),i())}var Ue=(()=>{class d{_webService;_router;showPageLoader=!1;showGridLoader=!1;selectedFilters={externalAccount:"",id:"",status:"Active"};filterEnabled=!1;followerDashBoardData;followerTableData=[];gridConfig;beFollowerDialog=E(ee);errorComponent;showFilters=!1;constructor(e,a){this._webService=e,this._router=a,this._webService.subscribeOnWebDataChange("PortfolioStandAloneComponent",l=>{this.recieveChildrenEmitter(l)}),this.setupFollowerTableConfig(),this.getFollowerDashboardData(),this.getFollowerTableData()}setupFollowerTableConfig(){let e=[{field:"refs.provider.name",headerName:"HOME.Provider",resizable:!1,cellRenderer:S,colId:"followerProfileCell"},{field:"activationStatus",headerName:"PROVIDERS_PROFILE.Activity",resizable:!1,cellRenderer:ce,colId:"activityCell"},{field:"externalAccount",headerName:"SUBSCRIPTION.Trading account",resizable:!1,cellRenderer:S,colId:"providerTradingAccountCell"},{field:"performance.fee",headerName:"OFFERS.Performance fee",resizable:!1,cellRenderer:S,colId:"performanceFeeCell"},{field:"registerTime",headerName:"PROVIDERS.Registered",sort:"desc",resizable:!1,cellRenderer:S,colId:"dateTimeCell"},{field:"actions",sortable:!1,headerName:"",cellRenderer:le,colId:"followerProfileRedirection"}];this.setupGridConfig(e)}setupGridConfig(e){this.gridConfig={maxHeight:"400px",noDataWarnMessage:"There are no subscriptions",gridOptions:{},agGridTheme:"ag-theme-alpine",pageSizeDropdownArr:[25,50,100],initialSelectedPageSize:25,columnDefination:e,enablePagination:!0,headerNameLangArr:e.map(a=>a.headerName),rowModelType:"clientSide",rowHeight:void 0}}getFollowerDashboardData(){this.showPageLoader=!0,this._webService.getFollowerDashboardDetails().subscribe({next:e=>{this.followerDashBoardData={},this.followerDashBoardData=e,this.showPageLoader=!1},error:e=>{this.showErrorWarnMessage(e?.error?.errorMessage),this.showPageLoader=!1},complete:()=>{this.showPageLoader=!1}})}getFollowerTableData(){this.showGridLoader=!0;let e=this.getFollowerParam();this._webService.getFollowerData(e).subscribe({next:a=>{this.followerTableData=[],this.followerTableData=a.items,this.showGridLoader=!1},error:a=>{this.showGridLoader=!1,this.showErrorWarnMessage(a?.error?.errorMessage)},complete:()=>{this.showGridLoader=!1}})}getFollowerParam(){let e={scope:this.selectedFilters.status,$count:!0};return this.getFilterQuery()&&(e.$filter=this.getFilterQuery()),e}getFilterQuery(){let e="";return this.selectedFilters.externalAccount&&(e+=`externalAccount eq ${this.selectedFilters.externalAccount} and `),this.selectedFilters.id&&(e+=`id eq ${this.selectedFilters.id} and `),e?e.slice(0,-4):""}showErrorWarnMessage(e){let a=this.errorComponent?.config;a.message=e||a.message,this.errorComponent?.openErrorSnackbar()}openNewFollowerDialog(){this.beFollowerDialog.open(se,{panelClass:"beFollower-dialog"}),this.beFollowerDialog.afterAllClosed.subscribe(()=>{})}toggleFilter(){this.filterEnabled=!this.filterEnabled}recieveChildrenEmitter(e){if(e.action=="follower_created"){let a=e.data;this._router.navigate([`/portal/subscriptions/${a.id}`]),this.beFollowerDialog.closeAll()}}refreshFollowerDataList(){this.getFollowerTableData()}applyFollowerFilter(){this.showFilters?(this.showFilters=!1,this.clearFilters()):this.showFilters=!0}clearFilters(){this.resetFilter(),this.getFollowerTableData()}resetFilter(){this.selectedFilters={externalAccount:"",id:"",status:"Active"}}ngOnDestroy(){this._webService.unSubscribeOnWebDataChange("PortfolioStandAloneComponent")}static \u0275fac=function(a){return new(a||d)(P(G),P(j))};static \u0275cmp=O({type:d,selectors:[["app-portfolio"]],viewQuery:function(a,l){if(a&1&&A(y,5),a&2){let p;B(p=R())&&(l.errorComponent=p.first)}},standalone:!0,features:[V],decls:4,vars:2,consts:[["appearance","outlined",1,"section-card"],["class","section-card-content",4,"ngIf"],["class","full-view-port-height d-flex justify-center align-center",4,"ngIf"],[1,"section-card-content"],[1,"home-card"],[1,"header","d-flex","justify-space-between","align-center"],[1,"header-title"],[1,"stats","d-flex","justify-space-between","g-20"],[1,"stats-card"],[1,"stats-info"],["class","d-flex justify-space-between flex-column",4,"ngFor","ngForOf"],[1,"metrics-table"],[1,"header-buttons","d-flex","justify-space-between"],[1,"d-flex","g-20","justify-center","align-center"],[1,"secondary-btn",3,"click"],["src","../../../../assets/icons/filterIcon.svg"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"d-flex","g-20","common-dropdown","align-center"],[1,"refresh-btn",3,"click"],[1,"primary-btn",3,"click"],["src","../../../../assets/icons/plusIcon.png"],[3,"gridConfig","gridData","showGridLoader"],[1,"d-flex","justify-space-between","flex-column"],["width","20","src","../../../../assets/icons/clear-icon.svg"],["matInput","","type","number",3,"ngModelChange","ngModel"],[3,"ngModelChange","selectionChange","ngModel"],[3,"value"],["src","../../../../assets/icons/searchIcon.svg"],["src","../../../../assets/icons/rotateIcon.svg"],[1,"full-view-port-height","d-flex","justify-center","align-center"],["src","../../../../assets/logo/ICM Logo Default 1.png"]],template:function(a,l){a&1&&(n(0,"mat-card",0),x(1,_e,86,71,"mat-card-content",1)(2,ge,2,0,"div",2),i(),h(3,"show-error-message")),a&2&&(t(),_("ngIf",!l.showPageLoader),t(),_("ngIf",l.showPageLoader))},dependencies:[k,L,N,W,q,Q,U,ae,ie,te,re,z,oe,ne,$,K,Z,X,Y,J,H,de,y],styles:[".stats-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.stats-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:16px}.stats-subline[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .positive[_ngcontent-%COMP%]{color:#027a48}.stats-subline[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .negative[_ngcontent-%COMP%]{color:#b42318}  .common-dropdown .mdc-text-field{background-color:var(--primaryWhite)!important;border:1px solid var(--border-color)!important;border-bottom:0px!important;border-radius:8px!important;width:150px}  .common-dropdown .mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple:before{border-bottom-color:var(--border-color)!important}  .common-dropdown .mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple:before{border-bottom-color:var(--border-color)!important}  .mat-mdc-form-field-subscript-wrapper{display:none}.refresh-btn[_ngcontent-%COMP%]{background:#fff;color:#000;border-radius:8px;font-weight:500;font-size:18px;border:1px solid #D0D5DD;padding:12px 18px;display:flex;justify-content:space-between;gap:10px;align-items:center;cursor:pointer;min-height:56px;transition:background-color .3s linear,border-radius .3s linear,padding .3s linear,width .3s linear;margin-bottom:0}"]})}return d})();export{Ue as PortfolioStandAloneComponent};
